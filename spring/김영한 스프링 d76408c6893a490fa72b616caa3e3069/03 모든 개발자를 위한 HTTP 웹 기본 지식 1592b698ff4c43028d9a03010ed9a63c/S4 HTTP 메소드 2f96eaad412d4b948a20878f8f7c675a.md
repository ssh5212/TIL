# S4 HTTP 메소드

---

---

# 1. HTTP API 만들기

![Untitled](S4%20HTTP%20%E1%84%86%E1%85%A6%E1%84%89%E1%85%A9%E1%84%83%E1%85%B3%202f96eaad412d4b948a20878f8f7c675a/Untitled.png)

![Untitled](S4%20HTTP%20%E1%84%86%E1%85%A6%E1%84%89%E1%85%A9%E1%84%83%E1%85%B3%202f96eaad412d4b948a20878f8f7c675a/Untitled%201.png)

URI 설계 시 중요한 것은 리소스 식별

## 리소스

리소스

- 수정, 삭제가 리소스가 아님
- 회원 자체가 리소스

리소스 식별 방법

- 회원 등록, 수정, 조회를 모두 배제
- 회웡니라는 리소스만 식별하면 됨 → 회원 리소스를 uri에 매핑

![Untitled](S4%20HTTP%20%E1%84%86%E1%85%A6%E1%84%89%E1%85%A9%E1%84%83%E1%85%B3%202f96eaad412d4b948a20878f8f7c675a/Untitled%202.png)

## 리소스와 행위를 분리

- URI는 리소스만 식별
- 리소스와 해당 리소스를 대상으로 하는 행위를 분리
    - 미네랄과 미네랄을 캐는 행위 자체는 분리되어야 함
    - 리소스 : 회원
    - 행위 : 조회, 등록, 삭제, 변경
- 리소스는 명사(미네랄), 행위는 동사(미네랄을 캐라)

---

# HTTP 메소드

get : 리소스 조회

post : 데이터 처리 (등록에 사용)

put : 리소스 대체 (없으면 생성)

patch : 리소스 부분 변경

delete : 리소스 삭제

head : get과 동일, 메시지 부분 제외하고 상태와 헤더만 반환

option

## GET

리소스 조회

서버에 전달할 데이터는 쿼리를 통해 전달

메세지 바디를 통해 데이터 전달 가능, get 메소드는 body에 데이터를 넣는 것을 권장하지 않음

![Untitled](S4%20HTTP%20%E1%84%86%E1%85%A6%E1%84%89%E1%85%A9%E1%84%83%E1%85%B3%202f96eaad412d4b948a20878f8f7c675a/Untitled%203.png)

![Untitled](S4%20HTTP%20%E1%84%86%E1%85%A6%E1%84%89%E1%85%A9%E1%84%83%E1%85%B3%202f96eaad412d4b948a20878f8f7c675a/Untitled%204.png)

## Post

- 요청 데이터 처리
- 메시지 body를 통해 서버로 요청 데이터를 전달
- 서버는 요청 데이터 처리
    - 메시지 바디를 통해 들어온 데이터를 처리하는 모든 기능
- 신규 리소스 등록

![Untitled](S4%20HTTP%20%E1%84%86%E1%85%A6%E1%84%89%E1%85%A9%E1%84%83%E1%85%B3%202f96eaad412d4b948a20878f8f7c675a/Untitled%205.png)

![Untitled](S4%20HTTP%20%E1%84%86%E1%85%A6%E1%84%89%E1%85%A9%E1%84%83%E1%85%B3%202f96eaad412d4b948a20878f8f7c675a/Untitled%206.png)

### POST 사용

- HTML 양식에 입력된 데이터 처리에 사용
- 게시판 글쓰기, 댓글
- 서버가 아직 식별하지 않은 새 리소스 생성
- 기존 자원에 데이터 추가
- 핵심 : 리소스 URI POST 요청이 오면 어떻게 처리할지 결정

![Untitled](S4%20HTTP%20%E1%84%86%E1%85%A6%E1%84%89%E1%85%A9%E1%84%83%E1%85%B3%202f96eaad412d4b948a20878f8f7c675a/Untitled%207.png)

- 이상적인 URI(명사로 모든 것을 해결)로 안되는 경우가 많음
- 뒤에 동사로 어떤 행위를 하는지를 표현하는 URI를 작성 : 컨트롤 URI

- 다른 메소드로 처리하기 애매한 경우 POST를 사용함
- POST는 데이터를 주고 받는 모든 것을 할 수 있음
    - 단 데이터 조회는 GET 사용

![Untitled](S4%20HTTP%20%E1%84%86%E1%85%A6%E1%84%89%E1%85%A9%E1%84%83%E1%85%B3%202f96eaad412d4b948a20878f8f7c675a/Untitled%208.png)

## PUT

- 리소스 대체
    - 기존 리소스가 있으면 완전히 대체 (기존 데이터 삭제 후 다시 생성)
        - 일부 데이터만 넘기면 넘어가지 않은 데이터는 생략되어버림
    - 리소스가 없으면 생성
    
    → 덮어쓰기라고 이해하면 편함
    
- 클라이언트가 리소스를 식별
    - POST와 다르게 클라이언트가 리소스 전체 경로(URI)를 알고 있음

![Untitled](S4%20HTTP%20%E1%84%86%E1%85%A6%E1%84%89%E1%85%A9%E1%84%83%E1%85%B3%202f96eaad412d4b948a20878f8f7c675a/Untitled%209.png)

![Untitled](S4%20HTTP%20%E1%84%86%E1%85%A6%E1%84%89%E1%85%A9%E1%84%83%E1%85%B3%202f96eaad412d4b948a20878f8f7c675a/Untitled%2010.png)

![Untitled](S4%20HTTP%20%E1%84%86%E1%85%A6%E1%84%89%E1%85%A9%E1%84%83%E1%85%B3%202f96eaad412d4b948a20878f8f7c675a/Untitled%2011.png)

## PATCH

![Untitled](S4%20HTTP%20%E1%84%86%E1%85%A6%E1%84%89%E1%85%A9%E1%84%83%E1%85%B3%202f96eaad412d4b948a20878f8f7c675a/Untitled%2012.png)

![Untitled](S4%20HTTP%20%E1%84%86%E1%85%A6%E1%84%89%E1%85%A9%E1%84%83%E1%85%B3%202f96eaad412d4b948a20878f8f7c675a/Untitled%2013.png)

## DELETE

- 리소스 제거

![Untitled](S4%20HTTP%20%E1%84%86%E1%85%A6%E1%84%89%E1%85%A9%E1%84%83%E1%85%B3%202f96eaad412d4b948a20878f8f7c675a/Untitled%2014.png)

---

# HTTP 메소스의 속성

- 안전
- 멱등
- 캐시 가능

![Untitled](S4%20HTTP%20%E1%84%86%E1%85%A6%E1%84%89%E1%85%A9%E1%84%83%E1%85%B3%202f96eaad412d4b948a20878f8f7c675a/Untitled%2015.png)

## 안전

- 호출해도 리소스가 변경되지 않음
    - get은 안전함
    - post, delete, put, patch는 안전하지 않음

→ 해당 리소스의 변화 여부에 따라 안전을 판단함

## 멱등

- f(f(x) = f(x)
- 한 번이든, 만 번이든 똑같은 요청을 호출했을 때 동일한 결과가 나옴
    - get : 동일한 결과
    - put : 똑같은 파일 업로드 하면 동일한 결과
    - delete : 결과 삭제, 여러 번 요청해도 결과가 동일함
    - post : 동일하지 않음 → 결제를 두 번 post하면 두 번 결제가 됨
- 외부 요인으로 인한 중간에 리소스 변경까지는 고려하지 않음

- 활용
    - 자동 복구 메커니즘
    - 실행이 제대로 일어났는지 판단이 서지 않을 때 멱등한 기능은 다시 실행해도 문제가 없음

## 캐시 가능

- 응답 결과를 캐시해서 사용해도 되는가?
    - 로컬 pc에 데이터를 저장하고 있음
- get, head, post, patch 캐시 가능
- 실제로 get, head 정도만 캐시로 사용
    - post, patch는 body까지 캐시 키로 고려해야 하므로 구현이 어려움

---